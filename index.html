<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Purple Rain</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">

<style>
:root {
  --bg1:#2a003d;
  --bg2:#120018;
  --glow:#b266ff;
  --text:#f6ebff;
}

* { box-sizing: border-box; }

body {
  margin:0;
  min-height:100vh;
  background: radial-gradient(circle at top, #3d0066, var(--bg2));
  color:var(--text);
  font-family:Montserrat, sans-serif;
  overflow:hidden;
}

canvas {
  position:fixed;
  inset:0;
  z-index:0;
}

main {
  position:relative;
  z-index:1;
  height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:2rem;
  text-align:center;
}

h1 {
  font-family:"Playfair Display", serif;
  letter-spacing:0.15em;
  margin-bottom:2rem;
  text-shadow:0 0 25px var(--glow);
}

#lyrics {
  font-size:1.4rem;
  max-width:700px;
  min-height:4em;
  line-height:1.6;
  opacity:0;
  transition:opacity 0.6s ease;
}

#lyrics.active {
  opacity:1;
}

#overlay {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.75);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:5;
}

#overlay button {
  background:none;
  border:2px solid var(--glow);
  color:var(--text);
  padding:1rem 2rem;
  font-size:1.1rem;
  cursor:pointer;
  letter-spacing:0.15em;
  box-shadow:0 0 25px rgba(178,102,255,0.6);
}

iframe {
  display:none; /* audio only */
}
</style>
</head>
<body>

<canvas id="rain"></canvas>

<div id="overlay">
  <button id="unmute">ENTER THE PURPLE RAIN</button>
</div>

<main>
  <h1>PURPLE RAIN</h1>
  <div id="lyrics"></div>
</main>

<div id="player"></div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
/* ================= YOUTUBE AUDIO ================= */

const VIDEO_ID = "TvnYmWpD_T8";
let player;

function onYouTubeIframeAPIReady() {
  player = new YT.Player("player", {
    videoId: VIDEO_ID,
    playerVars: {
      autoplay: 1,
      controls: 0,
      modestbranding: 1,
      rel: 0,
      playsinline: 1,
      mute: 1
    },
    events: {
      onReady: () => {
        player.playVideo();
        startLyricSync();
      }
    }
  });
}

document.getElementById("unmute").onclick = () => {
  player.unMute();
  document.getElementById("overlay").style.display = "none";
};

/* ================= LYRICS SYNC ================= */
/*
  ⚠️ COPYRIGHT NOTICE
  Paste the lyrics you legally own below.
  Format:
  { time: seconds, text: "lyric line" }
*/

const lyrics = [
  // EXAMPLE ONLY — REPLACE WITH REAL LYRICS
  { time: 0, text: "…" },
  { time: 15, text: "…" },
  { time: 30, text: "…" }
];

const lyricBox = document.getElementById("lyrics");
let currentLine = -1;

function startLyricSync() {
  setInterval(() => {
    if (!player || !player.getCurrentTime) return;
    const t = player.getCurrentTime();

    for (let i = lyrics.length - 1; i >= 0; i--) {
      if (t >= lyrics[i].time && currentLine !== i) {
        currentLine = i;
        lyricBox.classList.remove("active");
        setTimeout(() => {
          lyricBox.textContent = lyrics[i].text;
          lyricBox.classList.add("active");
        }, 300);
        break;
      }
    }
  }, 300);
}

/* ================= PURPLE RAIN EFFECT ================= */

const canvas = document.getElementById("rain");
const ctx = canvas.getContext("2d");
let drops = [];

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  drops = Array.from({ length: canvas.width / 18 }, () => ({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    l: Math.random() * 20 + 10,
    s: Math.random() * 4 + 2
  }));
}
window.addEventListener("resize", resize);
resize();

function rain() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.strokeStyle="rgba(178,102,255,0.35)";
  ctx.lineWidth=1;

  drops.forEach(d=>{
    ctx.beginPath();
    ctx.moveTo(d.x,d.y);
    ctx.lineTo(d.x,d.y+d.l);
    ctx.stroke();
    d.y+=d.s;
    if(d.y>canvas.height) d.y=-20;
  });
  requestAnimationFrame(rain);
}
rain();
</script>

</body>
</html>
